# ======================================
# گره چهاربعدی
# ======================================
class Node:
    def init(self, data):
        # داده اصلی گره
        self.data = data
        # اشاره‌گر به گره بعدی
        self.next = None
        # اشاره‌گر به گره قبلی
        self.prev = None
        # اشاره‌گر به گره زیرمجموعه پایین
        self.down = None
        # اشاره‌گر به گره زیرمجموعه بالا
        self.up = None


# ======================================
# لیست پیوندی چهاربعدی
# ======================================
class FourDimensionalLinkedList:
    def init(self):
        # سر لیست
        self.head = None

    # ---------- بررسی وضعیت ----------
    def is_empty(self):
        # آیا لیست خالی است؟
        return self.head is None

    # ---------- افزودن گره ----------
    def add_first(self, data):
        # افزودن گره در ابتدا
        new_node = Node(data)
        if not self.is_empty():
            self.head.prev = new_node
            new_node.next = self.head
        self.head = new_node

    def add_last(self, data):
        # افزودن گره در انتها
        new_node = Node(data)
        if self.is_empty():
            self.head = new_node
            return
        temp = self.head
        while temp.next:
            temp = temp.next
        temp.next = new_node
        new_node.prev = temp

    # ---------- حذف گره ----------
    def remove_first(self):
        # حذف اولین گره
        if self.is_empty():
            return None
        value = self.head.data
        self.head = self.head.next
        if self.head:
            self.head.prev = None
        return value

    def remove_last(self):
        # حذف آخرین گره
        if self.is_empty():
            return None
        temp = self.head
        while temp.next:
            temp = temp.next
        if temp.prev:
            temp.prev.next = None
        else:
            self.head = None
        return temp.data

    # ---------- جستجو و شمارش ----------
    def search(self, data):
        # جستجوی یک داده در لیست
        temp = self.head
        while temp:
            if temp.data == data:
                return True
            temp = temp.next
        return False

    def count(self):
        # شمارش کل گره‌ها
        cnt = 0
        temp = self.head
        while temp:
            cnt += 1
            temp = temp.next
        return cnt

    # ---------- نمایش ----------
    def display(self):
        # نمایش لیست اصلی
        temp = self.head
        while temp:
            print(temp.data, end=" <-> ")
            temp = temp.next
        print("None")

    # ---------- مدیریت شاخه‌های پایین و بالا ----------
    def add_down(self, parent_data, child_data):
        # افزودن گره به شاخه پایین گره مشخص
        temp = self.head
        while temp:
            if temp.data == parent_data:
                temp.down = Node(child_data)
                return
            temp = temp.next

    def add_up(self, parent_data, child_data):
        # افزودن گره به شاخه بالا گره مشخص
        temp = self.head
        while temp:
            if temp.data == parent_data:
                temp.up = Node(child_data)
                return
            temp = temp.next

    def remove_down(self, data):
        # حذف گره پایین گره مشخص
        temp = self.head
        while temp:
            if temp.data == data:
                temp.down = None
                return
            temp = temp.next

    def remove_up(self, data):
        # حذف گره بالا گره مشخص
        temp = self.head
        while temp:
            if temp.data == data:
                temp.up = None
                return
            temp = temp.next

    def has_down(self, data):
        # بررسی وجود شاخه پایین برای گره مشخص
        temp = self.head
        while temp:
            if temp.data == data:
                return temp.down is not None
            temp = temp.next
        return False
        def has_up(self, data):
        # بررسی وجود شاخه بالا برای گره مشخص
        temp = self.head
        while temp:
            if temp.data == data:
                return temp.up is not None
            temp = temp.next
        return False

    # ---------- پاکسازی ----------
    def clear(self):
        # حذف همه گره‌ها و شاخه‌ها
        self.head = None
